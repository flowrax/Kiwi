<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Expeditie Kiwi</title>

<link rel="stylesheet" href="css/style.css">
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.5/dist/leaflet.css"
 integrity="sha256-sA+e2bM4s3apz2xkY7RkZ6mQ2pFzH8jLr8a8tE/6ooc=" crossorigin=""/>

<style>
  /* Zorg dat de kaart zichtbaar is */
  #visited-map {
    height: 500px;
    width: 100%;
    border: 1px solid #ccc;
    margin-bottom: 2rem;
  }
</style>

</head>
<body>

<nav>
  <div class="nav-inner">
    <div class="brand">
      <a href="index.html">
        <img src="img/logo.png" alt="Expeditie Kiwi Logo" class="logo">
        Expeditie Kiwi
      </a>
    </div>
    <ul class="nav-links">
      <li><a href="index.html">Home</a></li>
      <li class="dropdown">
        <a href="over.html">Over ▾</a>
        <ul class="dropdown-menu">
          <li><a href="bouw-bus.html">Bouw van de bus</a></li>
          <li><a href="strips.html">Strips</a></li>
        </ul>
      </li>
      <li><a href="contact.html">Contact</a></li>
      <li><a href="blog.html">Blog</a></li>
    </ul>
  </div>
</nav>

<section class="hero">
  <div class="shape shape1"></div>
  <div class="shape shape2"></div>
  <div class="shape shape3"></div>
  <div class="sparkle" style="top:20%; left:15%;"></div>
  <div class="sparkle" style="top:40%; left:70%;"></div>
  <div class="sparkle" style="top:60%; left:30%;"></div>
  <div class="sparkle" style="top:80%; left:50%;"></div>
  <h1>Welkom bij Expeditie Kiwi</h1>
  <p>Ontdek avonturen, blogs en verhalen vol inspiratie!</p>
  <a href="blog.html" class="btn">Bekijk Blogs</a>
</section>

<section class="counters">
  <div class="counter" id="counterBlogs">
    <span class="count">0</span>
    <span class="counter-label">Blogs</span>
  </div>
  <div class="counter" id="counterLanden">
    <span class="count">0</span>
    <span class="counter-label">Landen bezocht</span>
  </div>
</section>

<div id="visited-map"></div>

<script src="blogs.js"></script>
<script src="https://unpkg.com/leaflet@1.9.5/dist/leaflet.js"></script>

<script>
document.addEventListener("DOMContentLoaded", () => {

  // Mapping landnamen (zoals in blogs.js) naar ISO codes
  const countryNameToCode = {
    "albanië": "AL","andorra": "AD","armenië": "AM","oostenrijk": "AT","azerbeidzjan": "AZ",
    "belgië": "BE","bosnie": "BA","bulgarije": "BG","kroatie": "HR","cyprus": "CY",
    "tsjechie": "CZ","denemarken": "DK","estland": "EE","finland": "FI","frankrijk": "FR",
    "georgie": "GE","duitsland": "DE","griekenland": "GR","hongarije": "HU","ijsland": "IS",
    "ierland": "IE","italie": "IT","kazachstan": "KZ","kosovo": "XK","letland": "LV",
    "liechtenstein": "LI","litouwen": "LT","luxemburg": "LU","malta": "MT","moldavie": "MD",
    "monaco": "MC","montenegro": "ME","nederland": "NL","noorwegen": "NO","polen": "PL",
    "portugal": "PT","roemenie": "RO","rusland": "RU","servie": "RS","slovenie": "SI",
    "slowakije": "SK","spanje": "ES","zweden": "SE","zwitserland": "CH",
    "turkije": "TR","iran": "IR","maleisie": "MY","sri lanka": "LK"
  };

  // Unieke bezochte landen uit blogs.js
  const visitedCountries = Array.from(new Set(
    window.blogs.map(blog => countryNameToCode[blog.land.toLowerCase()]).filter(Boolean)
  ));

  // Counters updaten
  const counterBlogs = document.querySelector("#counterBlogs .count");
  const counterLanden = document.querySelector("#counterLanden .count");

  if(counterBlogs) counterBlogs.textContent = window.blogs.length;
  if(counterLanden) counterLanden.textContent = visitedCountries.length;

  // Init Leaflet-kaart
  const map = L.map('visited-map').setView([20, 0], 2);

  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '&copy; OpenStreetMap contributors'
  }).addTo(map);

  // Laad GeoJSON en style landen
  fetch('https://raw.githubusercontent.com/johan/world.geo.json/master/countries.geo.json')
    .then(res => res.json())
    .then(geojson => {

      function style(feature) {
        return {
          fillColor: visitedCountries.includes(feature.id) ? '#f9a825' : '#ccc',
          weight: 1,
          opacity: 1,
          color: 'white',
          fillOpacity: 0.7
        };
      }

      L.geoJson(geojson, {
        style: style,
        onEachFeature: function(feature, layer) {

          layer.bindTooltip(feature.properties.name);

          layer.on('click', function() {
            const blogsForCountry = window.blogs.filter(
              blog => countryNameToCode[blog.land.toLowerCase()] === feature.id
            );

            let popupContent = `<strong>${feature.properties.name}</strong><br>`;
            if (blogsForCountry.length > 0) {
              blogsForCountry.forEach(blog => {
                popupContent += `${blog.title}<br>`;
              });
            } else {
              popupContent += "Geen blogs beschikbaar";
            }

            layer.bindPopup(popupContent).openPopup();
          });
        }
      }).addTo(map);
    });

});
</script>

<footer>
  &copy; 2025 Expeditie Kiwi
</footer>

</body>
</html>
